{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2022-12-11 15:33:04.074817",
 "css": ".rf-top {\n    margin:0 !important;\n}\n\n.rf-font-size {\n    font-size:10px !important\n}",
 "custom_format": 1,
 "default_print_language": "en-US",
 "disabled": 0,
 "doc_type": "Party Statement",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "<style>\n\t.print-format table, .print-format tr, \n\t.print-format td, .print-format div, .print-format p, .print-format b {\n\t\tfont-family: Tahoma;\n\t\tline-height: 100%;\n\t\tvertical-align: middle;\n\t}\n\t@media screen {\n\t\t.print-format {\n\t\t\twidth: 8.3in;\n\t\t\tpadding: 0.20in;\n\t\t\tmin-height: 11.7in;\n\t\t\t\n\t\t}\n\t}\n\t\n\n</style>\n<div class=\"rf-font-size\">\n    {% if doc.is_customer_statement == 0 %}\n        \n        <h5 class=\"text-center p-3\">STATEMENT OF ACCOUNTS</h5>\n        <table style=\"font-size:12px; font-family: Tahoma; width:80%;\">\n            <tr>\n                <td class=\"text-left\">Sales Person:</td>\n                <td class=\"text-left\">{{ doc.employee_name }}</td>\n            </tr>\n            <tr>\n                <td class=\"text-left\">Statement Period :</td>\n                <td class=\"text-left\">{{ frappe.format(doc.from_date, {'fieldtype': 'Date'}) }} To {{ frappe.format(doc.to_date, {'fieldtype': 'Date'}) }}</td>\n            </tr>\n        </table>\n        <div class=\"p-2\"></div>\n        \n        <div class=\"page-break\">\n            <div class=\"mt-4\"></div>\n            {% if doc.include_ageing == 1 %}\n                <h5>Ageing Details USD</h5>\n                <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                    <thead>\n                        <tr>\n                            <th>Customer ID</th>\n                            <th>Customer Name</th>\n                            <th>Age (0-30)</th>\n                            <th>Age (31-60)</th>\n                            <th>Age (61-90)</th>\n                            <th>Above 90</th>\n                            <th>Unallocated Payment</th>\n                            <th>Not Due</th>\n                            <th>Balance</th>\n                            <th>Net Balnce</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {% set usd_bal_30 = namespace(value=0)%}\n                        {% set usd_bal_60 = namespace(value=0)%}\n                        {% set usd_bal_90 = namespace(value=0)%}\n                        {% set usd_bal_120 = namespace(value=0)%}\n                        {% set usd_bal = namespace(value=0)%}\n                        {% set usd_unalloc_amt = namespace(value=0)%}\n                        {% set usd_unalloc_amt_net = namespace(value=0)%}\n                        \n                        {% set usd_no_due_sum = namespace(value=0)%}\n                        \n                        {% for age in doc.ageing_details %}\n                            {% if frappe.utils.fmt_money(age.balance) != 0 %}\n                                {% set usd_bal_all = namespace(value=0)%}\n                                \n                                {% set usd_bal_after_payment = namespace(value=0)%}\n                                {% set un_alloc_usd = get_unallocated_payment(doc.company,age.party,doc.employee,'USD') %}\n                                {% set usd_unalloc_amt.value=usd_unalloc_amt.value +(un_alloc_usd[0].unallocated_amount) %}\n                                \n                                {% set not_due_amt = get_not_due_amount(doc.company,age.party,doc.employee,'USD', doc.to_date) %}\n                                {% set usd_no_due_sum.value=usd_no_due_sum.value +(not_due_amt[0].no_due) %}\n                                \n                                {% set usd_bal_all.value = 0 %}\n                                \n                                {% set usd_bal_30.value=usd_bal_30.value +(age.age_30) %}\n                                {% set usd_bal_60.value=usd_bal_60.value +(age.age_60) %}\n                                {% set usd_bal_90.value=usd_bal_90.value +(age.age_90) %}\n                                {% set usd_bal_120.value=usd_bal_120.value +(age.above_120) %}\n                                {% set usd_bal.value=usd_bal.value +(age.balance - not_due_amt[0].no_due) %}\n                                \n                                {% set usd_bal_all.value = age.age_30 + age.age_60 + age.age_90 %}\n                                \n                                \n                                {% set usd_bal_after_payment.value = (age.balance - not_due_amt[0].no_due) - usd_unalloc_amt.value %}\n                                {% set usd_unalloc_amt_net.value = usd_unalloc_amt_net.value + ((age.balance - not_due_amt[0].no_due)-un_alloc_usd[0].unallocated_amount+not_due_amt[0].no_due) %}\n                                \n                                <tr>\n                                    <td>{{ age.party }}</td>\n                                    <td>{{ age.party_name }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_30) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_60) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_90) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.above_120) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(un_alloc_usd[0].unallocated_amount) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(not_due_amt[0].no_due) }}</td>\n                                    {% if usd_bal_all.value == age.balance %}\n                                        <td>{{ frappe.utils.fmt_money(age.balance - not_due_amt[0].no_due) }}</td>\n                                    {% else %}\n                                        <th>{{ frappe.utils.fmt_money(age.balance - not_due_amt[0].no_due) }}</th>\n                                    {% endif %}\n                                    <td>{{ frappe.utils.fmt_money((age.balance - not_due_amt[0].no_due)-un_alloc_usd[0].unallocated_amount+not_due_amt[0].no_due) }}</td>\n                                </tr>\n                            {% endif %}\n                        {% endfor%}\n                        {% set cust_no_age = get_unallocated_payment_not_in_ageing(doc.company, doc.employee, 'USD', doc.name) %}\n                        {% for row in cust_no_age %}\n                            {% set not_due_amt = get_not_due_amount(doc.company,row.party,doc.employee,'USD',doc.to_date) %}\n                            {% set usd_no_due_sum.value=usd_no_due_sum.value +(not_due_amt[0].no_due) %}\n                            {% set usd_bal.value=usd_bal.value +(row.unallocated_amount *-1) %}\n                            {% set usd_unalloc_amt_net.value = usd_unalloc_amt_net.value + (row.unallocated_amount *-1) %}\n                            \n                            <tr>\n                                <td>{{ row.party }}</td>\n                                <td>{{ frappe.db.get_value('Customer', row.party, 'customer_name') }}</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>{{ row.unallocated_amount }}</td>\n                                <td>{{ frappe.utils.fmt_money(not_due_amt[0].no_due) }}</td>\n                                <td>{{ row.unallocated_amount *-1 }}</td>\n                                <td>{{ row.unallocated_amount *-1}}</td>\n                            </tr>\n                        {% endfor%}\n                        <tr style=\"border: 1px solid black;\">\n                            <th colspan=\"2\" style=\"font-weight:bold:\">Total In USD</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_30.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_60.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_90.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_120.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_unalloc_amt.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_no_due_sum.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_unalloc_amt_net.value) }}</th>\n                        </tr>\n                    </tbody>\n                </table>\n            {% endif %}\n            <div class=\"mt-4\"></div>\n            {% if doc.include_ageing == 1 %}\n                <h5>Ageing Details IQD</h5>\n                <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                    <thead>\n                        <tr>\n                            <th>Customer ID</th>\n                            <th>Customer Name</th>\n                            <th>Age (0-30)</th>\n                            <th>Age (31-60)</th>\n                            <th>Age (61-90)</th>\n                            <th>Above 90</th>\n                            <th>Unallocated Payment</th>\n                            <th>Not Due</th>\n                            <th>Balance</th>\n                            <th>Net Balance</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {% set iqd_bal_30 = namespace(value=0)%}\n                        {% set iqd_bal_60 = namespace(value=0)%}\n                        {% set iqd_bal_90 = namespace(value=0)%}\n                        {% set iqd_bal_120 = namespace(value=0)%}\n                        {% set iqd_bal = namespace(value=0)%}\n                        \n                        {% set iqd_no_due_sum = namespace(value=0)%}\n                        \n                        {% set iqd_unalloc_amt = namespace(value=0)%}\n                        {% set iqd_unalloc_amt_net = namespace(value=0)%}\n                        \n                        {% for age in doc.ageing_details_iqd %}\n                            {% if frappe.utils.fmt_money(age.balance) != 0 %}\n                            \n                                {% set iqd_bal_all = namespace(value=0)%}\n                                {% set iqd_bal_all.value = 0 %}\n                                \n                                {% set iqd_bal_after_payment = namespace(value=0)%}\n                                {% set un_alloc_iqd = get_unallocated_payment(doc.company,age.party,doc.employee,'IQD') %}\n                                {% set iqd_unalloc_amt.value=iqd_unalloc_amt.value +(un_alloc_iqd[0].unallocated_amount) %}\n                                \n                                {% set iqd_not_due_amt = get_not_due_amount(doc.company,age.party,doc.employee,'IQD', doc.to_date) %}\n                                {% set iqd_no_due_sum.value=iqd_no_due_sum.value +(iqd_not_due_amt[0].no_due) %}\n                                \n                                \n                                {% set iqd_bal_30.value=iqd_bal_30.value +(age.age_30) %}\n                                {% set iqd_bal_60.value=iqd_bal_60.value +(age.age_60) %}\n                                {% set iqd_bal_90.value=iqd_bal_90.value +(age.age_90) %}\n                                {% set iqd_bal_120.value=iqd_bal_120.value +(age.above_120) %}\n                                {% set iqd_bal.value=iqd_bal.value +(age.balance - iqd_not_due_amt[0].no_due) %}\n                                \n                                {% set iqd_bal_all.value = age.age_30 + age.age_60 + age.age_90 %}\n                                \n                                {% set iqd_bal_after_payment.value = iqd_bal_all.value - iqd_unalloc_amt.value %}\n                                \n                                {% set iqd_unalloc_amt_net.value = iqd_unalloc_amt_net.value + ((age.balance - iqd_not_due_amt[0].no_due)-un_alloc_iqd[0].unallocated_amount+iqd_not_due_amt[0].no_due) %}\n                                \n                                <tr>\n                                    <td>{{ age.party }}</td>\n                                    <td>{{ age.party_name }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_30) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_60) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.age_90) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(age.above_120) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(un_alloc_iqd[0].unallocated_amount) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(iqd_not_due_amt[0].no_due) }}</td>\n                                    {% if iqd_bal_all.value == age.balance %}\n                                        <td>{{ frappe.utils.fmt_money(age.balance - iqd_not_due_amt[0].no_due) }}</td>\n                                    {% else %}\n                                        <th>{{ frappe.utils.fmt_money(age.balance - iqd_not_due_amt[0].no_due) }}</th>\n                                    {% endif %}\n                                    <td>{{ frappe.utils.fmt_money((age.balance - iqd_not_due_amt[0].no_due) - un_alloc_iqd[0].unallocated_amount+iqd_not_due_amt[0].no_due) }}</td>\n                                    \n                                </tr>\n                            {% endif %}\n                        {% endfor%}\n                        {% set cust_no_age = get_unallocated_payment_not_in_ageing(doc.company, doc.employee, 'IQD', doc.name) %}\n                        {% for row in cust_no_age %}\n                            {% set iqd_not_due_amt = get_not_due_amount(doc.company,row.party,doc.employee,'IQD',doc.to_date) %}\n                            {% set iqd_no_due_sum.value=iqd_no_due_sum.value +(iqd_not_due_amt[0].no_due) %}\n                            \n                            {% set iqd_bal.value=iqd_bal.value +(row.unallocated_amount *-1) %}\n                            {% set iqd_unalloc_amt_net.value = iqd_unalloc_amt_net.value + (row.unallocated_amount *-1) %}\n                            <tr>\n                                <td>{{ row.party }}</td>\n                                <td>{{ frappe.db.get_value('Customer', row.party, 'customer_name') }}</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>0.00</td>\n                                <td>{{ row.unallocated_amount }}</td>\n                                <td>{{ frappe.utils.fmt_money(iqd_not_due_amt[0].no_due) }}</td>\n                                <td>{{ row.unallocated_amount *-1 }}</td>\n                                <td>{{ row.unallocated_amount *-1}}</td>\n                            </tr>\n                        {% endfor%}\n                        <tr style=\"border: 1px solid black;\">\n                            <th colspan=\"2\" style=\"font-weight:bold:\">Total In IQD</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_30.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_60.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_90.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_120.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_unalloc_amt.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_no_due_sum.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal.value) }}</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_unalloc_amt_net.value) }}</th>\n                        </tr>\n                    </tbody>\n                </table>\n            {% endif %}\n            <div class=\"p-3\"></div>\n        </div>\n    {% endif %}\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2023-04-12 11:20:59.214946",
 "modified_by": "Administrator",
 "module": "Freeline",
 "name": "Consolidated Statement",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}