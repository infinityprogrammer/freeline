{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2022-09-22 14:51:31.483019",
 "css": ".rf-top {\n    margin:0 !important;\n}\n\n.rf-font-size {\n    font-size:10px !important\n}",
 "custom_format": 1,
 "default_print_language": "en-US",
 "disabled": 0,
 "doc_type": "Party Statement",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "<style>\n\t.print-format table, .print-format tr, \n\t.print-format td, .print-format div, .print-format p, .print-format b {\n\t\tfont-family: Tahoma;\n\t\tline-height: 100%;\n\t\tvertical-align: middle;\n\t}\n\t@media screen {\n\t\t.print-format {\n\t\t\twidth: 8.3in;\n\t\t\tpadding: 0.20in;\n\t\t\tmin-height: 11.7in;\n\t\t\t\n\t\t}\n\t}\n</style>\n\n<div class=\"rf-font-size\">\n    {% if doc.is_customer_statement == 1 %}\n        {% if letter_head %}\n            {{ letter_head }}\n        {% endif %}\n        <h5 class=\"text-center p-3\">STATEMENT OF ACCOUNTS SALES REP WISE</h5>\n        <table style=\"font-size:12px; font-family: Tahoma; width:90%;margin: 0 auto;\">\n            <tr>\n                <td class=\"text-left\">Customer :</td>\n                <td class=\"text-right\">{{ doc.customer }}</td>\n                <td></td>\n                <td class=\"text-left\">Company:</td>\n                <td class=\"text-right\">{{ doc.company }}</td>\n            </tr>\n            <tr>\n                <td class=\"text-left\">Customer Name:</td>\n                <td class=\"text-right\">{{ doc.customer_name }}</td>\n                <td></td>\n                <td class=\"text-left\">Statement Period :</td>\n                <td class=\"text-right\">{{ frappe.format(doc.from_date, {'fieldtype': 'Date'}) }} To {{ frappe.format(doc.to_date, {'fieldtype': 'Date'}) }}</td>\n            </tr>\n        </table>\n        {% set dist_emp = get_dist_employee(doc.customer, doc.from_date, doc.to_date, doc.company) %}\n        {% set global_bal = namespace(value=0)%}\n        {% if doc.include_statement == 1 %}\n            {% for emp in dist_emp %}\n                <div class=\"pt-3\"></div>\n                {% set emp_bal = namespace(value=0)%}\n                {% set soa_employee = emp.employee %}\n                {% set emp_opening = get_customer_opening(doc.company,doc.employee,doc.customer,doc.from_date) %}\n                {% set soa_employee_name = frappe.db.get_value('Employee', emp.employee, 'employee_name') %}\n                {% if soa_employee != 'Z' %}\n                    <h6>Sales Rep : {{ soa_employee }} : {{ soa_employee_name }}</h6>\n                {% endif %}\n                \n                {% if soa_employee == 'Z' %}\n                    <h6>Sales Rep : Sales Rep Not Found</h6>\n                {% endif %}\n                {% set emp_bal.value=emp_bal.value +(emp_opening[0].net_balance) %}\n                {% set emp_statement = sales_rep_statement_details(doc.company, doc.from_date,doc.to_date,doc.customer,soa_employee) %}\n                <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                    <thead>\n                        <tr>\n                            <th>Date</th>\n                            <th>Voucher No</th>\n                            <th>Debit</th>\n                            <th>Credit</th>\n                            <th>Balance</th>\n                            <th>Against</th>\n                            <th>Remark</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {% if soa_employee != 'Z' %}\n                            <tr>\n                                <th colspan=\"4\">Opening</th>\n                                <th>{{ emp_opening[0].net_balance }}</th>\n                                <th></th>\n                                <th></th>\n                            </tr>\n                            {% for d in emp_statement %}\n                                {% set emp_bal.value=emp_bal.value +(d.debit_in_account_currency - d.credit_in_account_currency) %}\n                                <tr>\n                                    <td>{{ frappe.format(d.posting_date, {'fieldtype': 'Date'}) }}</td>\n                                    <td>{{ d.voucher_no }}</td>\n                                    <td>{{ frappe.utils.fmt_money(d.debit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(d.credit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(emp_bal.value) }}</td>\n                                    {% if d.voucher_no != d.against_voucher %}\n                                    \t<td>{{ d.against_voucher }}</td>\n                                    {% else %}\n                                    \t<td></td>\n                                    {% endif %}\n                                    <td>{{ d.remarks }}</td>\n                                </tr>\n                            {% endfor%}\n                            <tr style=\"border: 1px solid black;\">\n                                <th colspan=\"6\" style=\"font-weight:bold:\">Closing Balance (Opening + Total)</th>\n                                <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(emp_bal.value) }}</th>\n                            </tr>\n                        {% set global_bal.value=global_bal.value +(emp_bal.value) %}\n                        {% endif %}\n                        {% if soa_employee == 'Z' %}\n                            {% set emp_null_opening = get_emp_null_opening(doc.company,doc.customer,doc.from_date) %}\n                            {% set emp_null_statement = emp_null_statement_details(doc.company, doc.from_date,doc.to_date,doc.customer) %}\n                            {% set emp_bal.value=emp_bal.value +(emp_null_opening[0].net_balance) %}\n                            <tr>\n                                <th colspan=\"4\">Opening</th>\n                                <th>{{ emp_null_opening[0].net_balance }}</th>\n                                <th></th>\n                                <th></th>\n                            </tr>\n                            {% for d in emp_null_statement %}\n                                {% set emp_bal.value=emp_bal.value +(d.debit_in_account_currency - d.credit_in_account_currency) %}\n                                <tr>\n                                    <td>{{ frappe.format(d.posting_date, {'fieldtype': 'Date'}) }}</td>\n                                    <td>{{ d.voucher_no }}</td>\n                                    <td>{{ frappe.utils.fmt_money(d.debit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(d.credit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(emp_bal.value)}}</td>\n                                    {% if d.voucher_no != d.against_voucher and d.against_voucher%}\n                                    \t<td>{{ d.against_voucher }}</td>\n                                    {% else %}\n                                    \t<td></td>\n                                    {% endif %}\n                                    <td>{{ d.remarks }}</td>\n                                </tr>\n                            {% endfor%}\n                            <tr style=\"border: 1px solid black;\">\n                                <th colspan=\"6\" style=\"font-weight:bold:\">Closing Balance (Opening + Total)</th>\n                                <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(emp_bal.value) }}</th>\n                            </tr>\n                        {% set global_bal.value=global_bal.value +(emp_bal.value) %}\n                        {% endif %}\n                    </tbody>\n                </table>\n            {% endfor%}\n        {% endif %}\n        {% if doc.include_ageing == 1 %}\n            <h5 class=\"pt-3\">Ageing Details</h5>\n            <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                <thead>\n                    <tr>\n                        <th>Party</th>\n                        <th>Party Name</th>\n                        <th>Age (0-30)</th>\n                        <th>Age (31-60)</th>\n                        <th>Age (61-90)</th>\n                        <th>Above 90</th>\n                        <th>Balance</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {% for age in doc.ageing_details %}\n                        <tr>\n                            <td>{{ age.party }}</td>\n                            <td>{{ age.party_name }}</td>\n                            <td>{{ frappe.utils.fmt_money(age.age_30) }}</td>\n                            <td>{{ frappe.utils.fmt_money(age.age_60) }}</td>\n                            <td>{{ frappe.utils.fmt_money(age.age_90) }}</td>\n                            <td>{{ frappe.utils.fmt_money(age.above_120) }}</td>\n                            <td>{{ frappe.utils.fmt_money(age.balance) }}</td>\n                        </tr>\n                    {% endfor%}\n                </tbody>\n            </table>\n        {% endif %}\n        {% if doc.include_statement == 1 %}\n            <h5 class=\"pt-5\" style=\"font-weight:bold;\">Closing Balance : {{ frappe.utils.fmt_money(global_bal.value) }}</h5>\n        {% endif %}\n    {% endif %}\n</div>\n\n\n\n\n\n\n",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2022-09-25 11:35:34.569487",
 "modified_by": "Administrator",
 "module": "Freeline",
 "name": "Customer Statement",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}