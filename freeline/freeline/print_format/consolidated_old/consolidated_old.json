{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-07-11 14:05:52.874998",
 "css": ".rf-top {\n    margin:0 !important;\n}\n\n.rf-font-size {\n    font-size:10px !important\n}",
 "custom_format": 1,
 "default_print_language": "en-US",
 "disabled": 0,
 "doc_type": "Party Statement",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "<style>\r\n\t.print-format table, .print-format tr, \r\n\t.print-format td, .print-format div, .print-format p, .print-format b {\r\n\t\tfont-family: Tahoma;\r\n\t\tline-height: 100%;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\t@media screen {\r\n\t\t.print-format {\r\n\t\t\twidth: 8.3in;\r\n\t\t\tpadding: 0.20in;\r\n\t\t\tmin-height: 11.7in;\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n</style>\r\n<div class=\"rf-font-size\">\r\n    {% if doc.is_customer_statement == 0 %}\r\n        \r\n        <h5 class=\"text-center p-3\">STATEMENT OF ACCOUNTS</h5>\r\n        <table style=\"font-size:12px; font-family: Tahoma; width:80%;\">\r\n            <tr>\r\n                <td class=\"text-left\">Sales Person:</td>\r\n                <td class=\"text-left\">{{ doc.employee_name }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"text-left\">Statement Period :</td>\r\n                <td class=\"text-left\">{{ frappe.format(doc.from_date, {'fieldtype': 'Date'}) }} To {{ frappe.format(doc.to_date, {'fieldtype': 'Date'}) }}</td>\r\n            </tr>\r\n        </table>\r\n        <div class=\"p-2\"></div>\r\n        \r\n        <div class=\"page-break\">\r\n            <div class=\"mt-4\"></div>\r\n            {% if doc.include_ageing == 1 %}\r\n                <h5>Ageing Details USD</h5>\r\n                <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Customer ID</th>\r\n                            <th>Customer Name</th>\r\n                            <th>Age (0-30)</th>\r\n                            <th>Age (31-60)</th>\r\n                            <th>Age (61-90)</th>\r\n                            <th>Above 90</th>\r\n                            <th>Unallocated Payment</th>\r\n                            <th>Not Due</th>\r\n                            <th>Overdue Balance</th>\r\n                            <th>Net Balnce</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {% set usd_bal_30 = namespace(value=0)%}\r\n                        {% set usd_bal_60 = namespace(value=0)%}\r\n                        {% set usd_bal_90 = namespace(value=0)%}\r\n                        {% set usd_bal_120 = namespace(value=0)%}\r\n                        {% set usd_bal = namespace(value=0)%}\r\n                        {% set usd_unalloc_amt = namespace(value=0)%}\r\n                        {% set usd_unalloc_amt_net = namespace(value=0)%}\r\n                        \r\n                        {% set usd_no_due_sum = namespace(value=0)%}\r\n                        \r\n                        {% for age in doc.ageing_details %}\r\n                            {% if frappe.utils.fmt_money(age.balance) != 0 %}\r\n                                {% set usd_bal_all = namespace(value=0)%}\r\n                                {% set usd_overdue_bal_all = namespace(value=0)%}\r\n                                \r\n                                {% set usd_bal_after_payment = namespace(value=0)%}\r\n                                {% set un_alloc_usd = get_unallocated_payment(doc.company,age.party,doc.employee,'USD') %}\r\n                                {% set usd_unalloc_amt.value=usd_unalloc_amt.value +(un_alloc_usd[0].unallocated_amount) %}\r\n                                \r\n                                {% set not_due_amt = get_not_due_amount(doc.company,age.party,doc.employee,'USD', doc.to_date) %}\r\n                                {% set usd_no_due_sum.value=usd_no_due_sum.value +(not_due_amt[0].no_due) %}\r\n                                \r\n                                {% set usd_bal_all.value = 0 %}\r\n                                \r\n                                \r\n                                {% set usd_bal_30.value=usd_bal_30.value +(age.age_30) %}\r\n                                {% set usd_bal_60.value=usd_bal_60.value +(age.age_60) %}\r\n                                {% set usd_bal_90.value=usd_bal_90.value +(age.age_90) %}\r\n                                {% set usd_bal_120.value=usd_bal_120.value +(age.above_120) %}\r\n                                {% set usd_bal.value=usd_bal.value +(age.balance - not_due_amt[0].no_due - un_alloc_usd[0].unallocated_amount) %}\r\n                                \r\n                                {% set usd_bal_all.value = age.age_30 + age.age_60 + age.age_90 %}\r\n                                \r\n                                \r\n                                {% set usd_bal_after_payment.value = (age.balance - not_due_amt[0].no_due) - usd_unalloc_amt.value %}\r\n                                {% set usd_unalloc_amt_net.value = usd_unalloc_amt_net.value + ((age.balance - not_due_amt[0].no_due)-un_alloc_usd[0].unallocated_amount+not_due_amt[0].no_due) %}\r\n                                {% set usd_overdue_bal_all.value = (age.balance - not_due_amt[0].no_due - un_alloc_usd[0].unallocated_amount) %}\r\n                                <tr>\r\n                                    <td>{{ age.party }}</td>\r\n                                    <td>{{ age.party_name }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_30) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_60) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_90) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.above_120) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(un_alloc_usd[0].unallocated_amount) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(not_due_amt[0].no_due) }}</td>\r\n                                    {% if usd_bal_all.value == usd_overdue_bal_all.value %}\r\n                                        <td>{{ frappe.utils.fmt_money(age.balance - not_due_amt[0].no_due - un_alloc_usd[0].unallocated_amount) }}</td>\r\n                                    {% else %}\r\n                                        <th>{{ frappe.utils.fmt_money(age.balance - not_due_amt[0].no_due - un_alloc_usd[0].unallocated_amount) }}</th>\r\n                                    {% endif %}\r\n                                    <td>{{ frappe.utils.fmt_money((age.balance - not_due_amt[0].no_due)-un_alloc_usd[0].unallocated_amount+not_due_amt[0].no_due) }}</td>\r\n                                </tr>\r\n                            {% endif %}\r\n                        {% endfor%}\r\n                        {% set cust_no_age = get_unallocated_payment_not_in_ageing(doc.company, doc.employee, 'USD', doc.name) %}\r\n                        {% for row in cust_no_age %}\r\n                            {% set not_due_amt = get_not_due_amount(doc.company,row.party,doc.employee,'USD',doc.to_date) %}\r\n                            {% set usd_no_due_sum.value=usd_no_due_sum.value +(not_due_amt[0].no_due) %}\r\n                            {% set usd_bal.value=usd_bal.value +(row.unallocated_amount *-1) %}\r\n                            {% set usd_unalloc_amt_net.value = usd_unalloc_amt_net.value + (row.unallocated_amount *-1) %}\r\n                            \r\n                            <tr>\r\n                                <td>{{ row.party }}</td>\r\n                                <td>{{ frappe.db.get_value('Customer', row.party, 'customer_name') }}</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>{{ row.unallocated_amount }}</td>\r\n                                <td>{{ frappe.utils.fmt_money(not_due_amt[0].no_due) }}</td>\r\n                                <td>{{ row.unallocated_amount *-1 }}</td>\r\n                                <td>{{ row.unallocated_amount *-1}}</td>\r\n                            </tr>\r\n                        {% endfor%}\r\n                        <tr style=\"border: 1px solid black;\">\r\n                            <th colspan=\"2\" style=\"font-weight:bold:\">Total In USD</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_30.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_60.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_90.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal_120.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_unalloc_amt.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_no_due_sum.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_bal.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(usd_unalloc_amt_net.value) }}</th>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            {% endif %}\r\n            <div class=\"mt-4\"></div>\r\n            {% if doc.include_ageing == 1 %}\r\n                <h5>Ageing Details IQD</h5>\r\n                <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Customer ID</th>\r\n                            <th>Customer Name</th>\r\n                            <th>Age (0-30)</th>\r\n                            <th>Age (31-60)</th>\r\n                            <th>Age (61-90)</th>\r\n                            <th>Above 90</th>\r\n                            <th>Unallocated Payment</th>\r\n                            <th>Not Due</th>\r\n                            <th>Overdue Balance</th>\r\n                            <th>Net Balance</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {% set iqd_bal_30 = namespace(value=0)%}\r\n                        {% set iqd_bal_60 = namespace(value=0)%}\r\n                        {% set iqd_bal_90 = namespace(value=0)%}\r\n                        {% set iqd_bal_120 = namespace(value=0)%}\r\n                        {% set iqd_bal = namespace(value=0)%}\r\n                        \r\n                        {% set iqd_no_due_sum = namespace(value=0)%}\r\n                        \r\n                        {% set iqd_unalloc_amt = namespace(value=0)%}\r\n                        {% set iqd_unalloc_amt_net = namespace(value=0)%}\r\n                        \r\n                        {% for age in doc.ageing_details_iqd %}\r\n                            {% if frappe.utils.fmt_money(age.balance) != 0 %}\r\n                            \r\n                                {% set iqd_bal_all = namespace(value=0)%}\r\n                                {% set iqd_bal_all.value = 0 %}\r\n                                {% set iqd_overdue_bal_all = namespace(value=0)%}\r\n                                \r\n                                {% set iqd_bal_after_payment = namespace(value=0)%}\r\n                                {% set un_alloc_iqd = get_unallocated_payment(doc.company,age.party,doc.employee,'IQD') %}\r\n                                {% set iqd_unalloc_amt.value=iqd_unalloc_amt.value +(un_alloc_iqd[0].unallocated_amount) %}\r\n                                \r\n                                {% set iqd_not_due_amt = get_not_due_amount(doc.company,age.party,doc.employee,'IQD', doc.to_date) %}\r\n                                {% set iqd_no_due_sum.value=iqd_no_due_sum.value +(iqd_not_due_amt[0].no_due) %}\r\n                                {% set iqd_bal_all.value = age.age_30 + age.age_60 + age.age_90 + age.above_120 %}\r\n                                \r\n                                {% set iqd_bal_30.value=iqd_bal_30.value +(age.age_30) %}\r\n                                {% set iqd_bal_60.value=iqd_bal_60.value +(age.age_60) %}\r\n                                {% set iqd_bal_90.value=iqd_bal_90.value +(age.age_90) %}\r\n                                {% set iqd_bal_120.value=iqd_bal_120.value +(age.above_120) %}\r\n                                {% set iqd_bal.value=iqd_bal.value +(iqd_bal_all.value - iqd_not_due_amt[0].no_due - un_alloc_iqd[0].unallocated_amount) %}\r\n                                \r\n                                \r\n                                \r\n                                {% set iqd_bal_after_payment.value = iqd_bal_all.value - iqd_unalloc_amt.value %}\r\n                                \r\n                                {% set iqd_unalloc_amt_net.value = iqd_unalloc_amt_net.value + ((iqd_bal_all.value - iqd_not_due_amt[0].no_due)-un_alloc_iqd[0].unallocated_amount+iqd_not_due_amt[0].no_due) %}\r\n                                {% set iqd_overdue_bal_all.value = (iqd_bal_all.value - iqd_not_due_amt[0].no_due - un_alloc_iqd[0].unallocated_amount) %}\r\n                                <tr>\r\n                                    <td>{{ age.party }}</td>\r\n                                    <td>{{ age.party_name }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_30) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_60) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.age_90) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(age.above_120) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(un_alloc_iqd[0].unallocated_amount) }}</td>\r\n                                    <td>{{ frappe.utils.fmt_money(iqd_not_due_amt[0].no_due) }}</td>\r\n                                    {% if iqd_bal_all.value == iqd_overdue_bal_all.value %}\r\n                                        <td>{{ frappe.utils.fmt_money(iqd_bal_all.value - iqd_not_due_amt[0].no_due - un_alloc_iqd[0].unallocated_amount) }}</td>\r\n                                    {% else %}\r\n                                        <th>{{ frappe.utils.fmt_money(iqd_bal_all.value - iqd_not_due_amt[0].no_due - un_alloc_iqd[0].unallocated_amount) }}</th>\r\n                                    {% endif %}\r\n                                    <td>{{ frappe.utils.fmt_money((iqd_bal_all.value - iqd_not_due_amt[0].no_due) - un_alloc_iqd[0].unallocated_amount+iqd_not_due_amt[0].no_due) }}</td>\r\n                                    \r\n                                </tr>\r\n                            {% endif %}\r\n                        {% endfor%}\r\n                        {% set cust_no_age = get_unallocated_payment_not_in_ageing(doc.company, doc.employee, 'IQD', doc.name) %}\r\n                        {% for row in cust_no_age %}\r\n                            {% set iqd_not_due_amt = get_not_due_amount(doc.company,row.party,doc.employee,'IQD',doc.to_date) %}\r\n                            {% set iqd_no_due_sum.value=iqd_no_due_sum.value +(iqd_not_due_amt[0].no_due) %}\r\n                            \r\n                            {% set iqd_bal.value=iqd_bal.value +(row.unallocated_amount *-1) %}\r\n                            {% set iqd_unalloc_amt_net.value = iqd_unalloc_amt_net.value + (row.unallocated_amount *-1) %}\r\n                            <tr>\r\n                                <td>{{ row.party }}</td>\r\n                                <td>{{ frappe.db.get_value('Customer', row.party, 'customer_name') }}</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>0.00</td>\r\n                                <td>{{ row.unallocated_amount }}</td>\r\n                                <td>{{ frappe.utils.fmt_money(iqd_not_due_amt[0].no_due) }}</td>\r\n                                <td>{{ row.unallocated_amount *-1 }}</td>\r\n                                <td>{{ row.unallocated_amount *-1}}</td>\r\n                            </tr>\r\n                        {% endfor%}\r\n                        <tr style=\"border: 1px solid black;\">\r\n                            <th colspan=\"2\" style=\"font-weight:bold:\">Total In IQD</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_30.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_60.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_90.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal_120.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_unalloc_amt.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_no_due_sum.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_bal.value) }}</th>\r\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(iqd_unalloc_amt_net.value) }}</th>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            {% endif %}\r\n            <div class=\"p-3\"></div>\r\n        </div>\r\n    {% endif %}\r\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2023-07-11 14:12:12.428052",
 "modified_by": "Administrator",
 "module": "Freeline",
 "name": "Consolidated Old",
 "owner": "rafi@tiejan.com",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}