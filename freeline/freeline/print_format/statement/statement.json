{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2022-08-29 16:08:29.605652",
 "css": ".rf-top {\n    margin:0 !important;\n}\n\n.rf-font-size {\n    font-size:10px !important\n}",
 "custom_format": 1,
 "default_print_language": "en-US",
 "disabled": 0,
 "doc_type": "Party Statement",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "<style>\n\t.print-format table, .print-format tr, \n\t.print-format td, .print-format div, .print-format p, .print-format b {\n\t\tfont-family: Tahoma;\n\t\tline-height: 100%;\n\t\tvertical-align: middle;\n\t}\n\t@media screen {\n\t\t.print-format {\n\t\t\twidth: 8.3in;\n\t\t\tpadding: 0.20in;\n\t\t\tmin-height: 11.7in;\n\t\t\t\n\t\t}\n\t}\n\t\n\n</style>\n<div class=\"rf-font-size\">\n    {% if doc.is_customer_statement == 0 %}\n        {% set dist_supp = get_statement_customer(doc.name) %}\n        {% for supp in dist_supp %}\n            {% if letter_head %}\n                {{ letter_head }}\n            {% endif %}\n            {% set bal= namespace(value=0)%}\n            <h5 class=\"text-center p-3\">STATEMENT OF ACCOUNTS</h5>\n            <table style=\"font-size:12px; font-family: Tahoma; width:80%;\">\n                <tr>\n                    <td class=\"text-left\">Customer :</td>\n                    <td class=\"text-right\">{{ supp.party }}</td>\n                    <td></td>\n                    <td class=\"text-left\">Sales Person:</td>\n                    <td class=\"text-left\">{{ doc.employee_name }}</td>\n                </tr>\n                <tr>\n                    <td class=\"text-left\">Customer Name:</td>\n                    <td class=\"text-right\">{{ supp.party_name }}</td>\n                    <td></td>\n                    <td class=\"text-left\">Statement Period :</td>\n                    <td class=\"text-left\">{{ frappe.format(doc.from_date, {'fieldtype': 'Date'}) }} To {{ frappe.format(doc.to_date, {'fieldtype': 'Date'}) }}</td>\n                </tr>\n                <!--<tr>-->\n                <!--    <td class=\"text-left\">Opening Balance:</td>-->\n                <!--    <td class=\"text-right\">0</td>-->\n                <!--</tr>-->\n            </table>\n            \n            {% set p_customer = supp.party %}\n            {% set c_opening = get_customer_opening(doc.company,doc.employee,p_customer,doc.from_date) %}\n            {% set customer_statement = get_customer_statement_details(doc.company, doc.from_date,doc.to_date,p_customer,doc.employee) %}\n            \n            {% set bal.value=bal.value +(c_opening[0].net_balance) %}\n            <div class=\"p-2\"></div>\n            <div class=\"page-break\">\n                {% if doc.include_statement == 1 %}\n                    <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                        <thead>\n                            <tr>\n                                <th>Date</th>\n                                <th>Voucher No</th>\n                                <!--<th>Delivery Note</th>-->\n                                <th>Debit</th>\n                                <th>Credit</th>\n                                <th>Balance</th>\n                                <th>Against</th>\n                                <th>Remark</th>\n                                <th>Due</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                        <tr>\n                            <th colspan=\"4\">Opening</th>\n                            <th>{{ c_opening[0].net_balance }}</th>\n                            <th></th>\n                            <th></th>\n                            <th></th>\n                        </tr>\n                        {% for d in customer_statement %}\n                            {% set bal.value=bal.value +(d.debit_in_account_currency - d.credit_in_account_currency) %}\n                                <tr>\n                                    <td>{{ frappe.format(d.posting_date, {'fieldtype': 'Date'}) }}</td>\n                                    <td>{{ d.voucher_no }}</td>\n                                    <!--<td></td>-->\n                                    <td>{{ frappe.utils.fmt_money(d.debit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(d.credit_in_account_currency) }}</td>\n                                    <td>{{ frappe.utils.fmt_money(bal.value) }}</td>\n                                    {% if d.voucher_no != d.against_voucher %}\n                                    \t<td>{{ d.against_voucher }}</td>\n                                    {% else %}\n                                    \t<td></td>\n                                    {% endif %}\n                                    {% if d.jv_remarks %}\n                                    \t<td>{{ d.jv_remarks }}</td>\n                                    {% else %}\n                                    \t<td></td>\n                                    {% endif %}\n                                    <td>{{ d.due_date }}</td>\n                                </tr>\n                        {% endfor%}\n                        <tr style=\"border: 1px solid black;\">\n                            <th colspan=\"7\" style=\"font-weight:bold:\">Closing Balance (Opening + Total)</th>\n                            <th style=\"font-weight:bold:\">{{ frappe.utils.fmt_money(bal.value) }}</th>\n                        </tr>\n                        </tbody>\n                    </table>\n                {% endif %}\n                <div class=\"mt-4\"></div>\n                {% if doc.include_ageing == 1 %}\n                    <h5>Ageing Details</h5>\n                    <table style=\"width:100%; font-size:10px; padding-top:5px;\" border=\"1\">\n                        <thead>\n                            <tr>\n                                <th>Party</th>\n                                <th>Party Name</th>\n                                <th>Age (0-30)</th>\n                                <th>Age (31-60)</th>\n                                <th>Age (61-90)</th>\n                                <th>Above 90</th>\n                                <th>Balance</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {% for age in doc.ageing_details %}\n                                {% if age.party == p_customer %}\n                                    <tr>\n                                        <td>{{ age.party }}</td>\n                                        <td>{{ age.party_name }}</td>\n                                        <td>{{ age.age_30 }}</td>\n                                        <td>{{ age.age_60 }}</td>\n                                        <td>{{ age.age_90}}</td>\n                                        <td>{{ age.above_120 }}</td>\n                                        <td>{{ age.balance }}</td>\n                                    </tr>\n                                {% endif %}\n                            {% endfor%}\n                        </tbody>\n                    </table>\n                {% endif %}\n                <div class=\"p-3\"></div>\n            </div>\n        {% endfor%}\n    {% endif %}\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2023-03-01 16:13:28.479732",
 "modified_by": "Administrator",
 "module": "Freeline",
 "name": "Statement",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}